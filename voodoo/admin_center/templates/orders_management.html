{% extends 'admin_base.html' %}
{% block javascript %}

<script type="text/javascript">
    $(function() {
        $( "#id_order_filter_creation_date_1" ).datepicker({dateFormat: 'dd.mm.yy'});
        $( "#id_order_filter_creation_date_2" ).datepicker({dateFormat: 'dd.mm.yy'});
    });
    
	function deleteAjax(item_id) {
		if (confirm("Удалить заказ?")) {
			$.ajax({
			    url: "order_delete/"+ item_id +"/",
			    type: "POST",
			    success: function() {
			    	$('#row_id_' + item_id).remove();
			    }
			});
		}
}
</script>
{% endblock %}
{% block content %}
<h3>Управление заказами</h3>
<form name="orders_management_form" action="/admin_center/orders_management" method="POST">
	<table>
		{{ form.as_table }}
	</table>
	<input type="submit" value="Применить фильтр">
</form>
{% if results %}
	<div>{{message}}</div>
	<div style="text-align: center">Краткое содержание заказов</div>
	<table class="admin-center-table" border="1" bordercolor="#9B9B9B" style="background-color:#FFFFFF;" width="100%" cellpadding="3" cellspacing="3">
		<thead>
			<tr class="table-header">
				<th style="width: 50px;">#</th>
				<th style="width: 110px;">Дата создания</th>
				<th style="width: 150px;">Заказчик</th>
				<th>Информация о заказе</th>
				<th style="width: 100px;">Статус заказа</th>
				<th style="width: 65px;">Действия</th>
			</tr>
		</thead>
		<tbody>
			{% for row in results %}
			<tr id="row_id_{{ row.id }}">
				<td style="text-align: center;">{{ row.id }}</td>
				<td style="text-align: center;">{{ row.creation_date|date:"d.m.y" }}</td>
				{% if row.user %}
					<td>{{ row.user.username }}</td>
				{% else %}
					<td>{{ row.client_name }}</td>
				{% endif %}
				<td>{{ row.order_info }}</td>
				<td style="text-align: center;">{{ row.order_status }}</td>
				<td>
					<div style="text-align: center" >
						<input class="highlightable_pointer" type="image" src="/static/images/pencil.gif" width="15" height="15" onclick="document.location = 'order_edit/{{ row.id }}';">
						<input class="highlightable_pointer" type="image" src="/static/images/delete.png" width="15" height="15" onclick="deleteAjax({{ row.id }}); return false;">
					</div>
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
{% else %}
	{{message}}
{% endif %}

{% endblock %}